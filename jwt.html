<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>AuthMaster — JWT</title>
    <link rel="icon" href="images/favicon.jpg">
    <script
      src="https://cdn.jsdelivr.net/npm/windicss-runtime@3.1.0/dist/windicss-runtime.min.js"
      defer></script>
    <link rel="stylesheet" href="css/styles.css">
  </head>
  <body>
    <div class="wrapper">
      <header class="header" role="banner">
        <div class="brand">
          <img src="images/logo.jpg" alt="AuthMaster logo" style="height:48px">
          <div class="brand__title"> AuthMaster — учебный проект</div>
        </div>

        <nav class="header__nav" role="navigation"
          aria-label="Главная навигация">
          <a href="index.html">Главная</a>
          <a href="jwt.html" class="active">JWT</a>
          <a href="oauth.html">OAuth 2.0</a>
          <a href="comparison.html">Сравнение</a>
          <a href="install.html">Установка</a>
          <a href="api.html">API</a>
          <a href="docs.html">Документация</a>
          <a href="contact.html">Контакты</a>
        </nav>

        <button class="burger" aria-label="Открыть меню" aria-expanded="false">
          <span class="burger__box" aria-hidden="true">
            <span class="burger__bar"></span>
            <span class="burger__bar"></span>
            <span class="burger__bar"></span>
          </span>
        </button>
      </header>

      <main class="page" role="main">
        <div class="main">
          <section class="card" aria-labelledby="page-title">
            <h1 id="page-title" class="page-title">JSON Web Tokens (JWT)</h1>
            <div class="flow-image">
              <img
                src="images/jwt.webp"
                srcset="images/jwt-400.webp 400w, images/jwt-800.webp 800w, images/jwt-1200.webp 1200w"
                sizes="(max-width: 768px) 100vw, 800px"
                alt="Логотип JWT"
                loading="lazy">
            </div>
            <p>JWT — это открытый стандарт (RFC 7519) для создания токенов
              доступа, основанный на формате JSON. Эти токены содержат
              закодированные данные о пользователе и используются для безопасной
              передачи информации между сторонами.</p>
          </section>

          <section class="card" id="video">
            <h2>Видеообзор JWT</h2>
            <p>Посмотрите это видео, чтобы лучше понять принципы работы JWT:</p>

            <div class="video-container">
              <div class="video-wrapper">
                <iframe
                  width="560"
                  height="315"
                  src="https://www.youtube.com/embed/7Q17ubqLfaM?si=FqO2iioZKAK9N3bC"
                  title="Объяснение JWT за 5 минут"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                  allowfullscreen>
                </iframe>
              </div>
              </div>
            </section>

            <section class="card" id="structure">
              <h2>Структура JWT токена</h2>
              <p>JWT состоит из трех частей, разделенных точками:</p>

              <div class="jwt-structure">
                <div class="jwt-part">
                  <h3>Header (Заголовок)</h3>
                  <p>Содержит метаданные о токене — тип токена и алгоритм
                    подписи.</p>
                  <pre><code>{
  "alg": "HS256",
  "typ": "JWT"
}</code></pre>
                </div>

                <div class="jwt-part">
                  <h3>Payload (Полезная нагрузка)</h3>
                  <p>Содержит утверждения (claims) — данные о пользователе и
                    дополнительную информацию.</p>
                  <pre><code>{
  "sub": "1234567890",
  "name": "John Doe",
  "iat": 1516239022
}</code></pre>
                </div>

                <div class="jwt-part">
                  <h3>Signature (Подпись)</h3>
                  <p>Проверяет целостность токена. Создается путем кодирования
                    header и payload с использованием секретного ключа.</p>
                  <pre><code>HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  secret
)</code></pre>
                </div>
              </div>

              <div class="jwt-example">
                <h3>Пример полного JWT токена:</h3>
                <div class="token-example">
                  <span
                    class="token-header">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span>.
                  <span
                    class="token-payload">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ</span>.
                  <span
                    class="token-signature">SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</span>
                </div>
              </div>
            </section>

            <section class="card" id="claims">
              <h2>Типы утверждений (Claims) в JWT</h2>

              <div class="claims-types">
                <div class="claims-category">
                  <h3>Зарегистрированные утверждения</h3>
                  <p>Стандартные поля, определенные в спецификации JWT:</p>
                  <ul>
                    <li><strong>iss (Issuer)</strong> — эмитент токена</li>
                    <li><strong>sub (Subject)</strong> — субъект токена (обычно
                      ID пользователя)</li>
                    <li><strong>aud (Audience)</strong> — получатель токена</li>
                    <li><strong>exp (Expiration Time)</strong> — время истечения
                      срока действия</li>
                    <li><strong>nbf (Not Before)</strong> — время, с которого
                      токен становится валидным</li>
                    <li><strong>iat (Issued At)</strong> — время создания
                      токена</li>
                    <li><strong>jti (JWT ID)</strong> — уникальный идентификатор
                      токена</li>
                  </ul>
                </div>

                <div class="claims-category">
                  <h3>Публичные утверждения</h3>
                  <p>Могут быть определены по соглашению между сторонами. Должны
                    быть зарегистрированы в IANA JSON Web Token Registry или
                    использовать устойчивые к коллизиям имена.</p>
                </div>

                <div class="claims-category">
                  <h3>Приватные утверждения</h3>
                  <p>Пользовательские поля, определены для конкретного случая
                    использования.</p>
                </div>
              </div>
            </section>

            <section class="card" id="algorithms">
              <h2>Алгоритмы подписи</h2>

              <div class="algorithms">
                <div class="algorithm">
                  <h3>HMAC + SHA256 (HS256)</h3>
                  <p><strong>Тип:</strong> Симметричный</p>
                  <p><strong>Описание:</strong> Использует один секретный ключ
                    для подписи и проверки. Быстрый и эффективный, но требует
                    безопасного обмена ключом.</p>
                </div>

                <div class="algorithm">
                  <h3>RSASSA-PKCS1-v1_5 + SHA256 (RS256)</h3>
                  <p><strong>Тип:</strong> Асимметричный</p>
                  <p><strong>Описание:</strong> Использует приватный ключ для
                    подписи и публичный для проверки. Более безопасен, но
                    медленнее.</p>
                </div>

                <div class="algorithm">
                  <h3>ECDSA + P-256 + SHA256 (ES256)</h3>
                  <p><strong>Тип:</strong> Асимметричный</p>
                  <p><strong>Описание:</strong> Использует эллиптические кривые.
                    Обеспечивает высокий уровень безопасности при меньшем
                    размере ключа.</p>
                </div>
              </div>
            </section>

            <section class="card" id="implementation">
              <h2>Реализация JWT в приложениях</h2>

              <div class="implementation-steps">
                <div class="step">
                  <h3>1. Создание токена</h3>
                  <p>После успешной аутентификации сервер генерирует JWT с
                    данными пользователя:</p>
                  <pre><code>// Пример на Node.js с библиотекой jsonwebtoken
const jwt = require('jsonwebtoken');

const token = jwt.sign(
  { 
    userId: user.id, 
    role: user.role 
  },
  process.env.JWT_SECRET,
  { expiresIn: '1h' }
);</code></pre>
                </div>

                <div class="step">
                  <h3>2. Передача токена клиенту</h3>
                  <p>Токен отправляется клиенту, обычно в заголовке ответа или в
                    теле:</p>
                  <pre><code>// В заголовке ответа
res.setHeader('Authorization', `Bearer ${token}`);

// Или в теле ответа
res.json({
  success: true,
  token: token,
  user: { id: user.id, name: user.name }
});</code></pre>
                </div>

                <div class="step">
                  <h3>3. Хранение на клиенте</h3>
                  <p>Клиент сохраняет токен для последующих запросов:</p>
                  <div class="storage-options">
                    <div class="storage-option">
                      <h4>HTTP-only Cookies (рекомендуется)</h4>
                      <p>Защищено от XSS-атак, но уязвимо к CSRF.</p>
                    </div>
                    <div class="storage-option">
                      <h4>LocalStorage/SessionStorage</h4>
                      <p>Удобно для SPA, но уязвимо к XSS-атакам.</p>
                    </div>
                    <div class="storage-option">
                      <h4>Memory</h4>
                      <p>Самый безопасный, но токен теряется при перезагрузке
                        страницы.</p>
                    </div>
                  </div>
                </div>

                <div class="step">
                  <h3>4. Проверка токена на сервере</h3>
                  <p>Сервер проверяет токен при каждом защищенном запросе:</p>
                  <pre><code>// Middleware для проверки JWT
const authMiddleware = (req, res, next) => {
  const token = req.headers.authorization?.split(' ')[1];
  
  if (!token) {
    return res.status(401).json({ message: 'Токен отсутствует' });
  }
  
  try {
    const decoded = jwt.verify(token, process.env.JWT_SECRET);
    req.user = decoded;
    next();
  } catch (error) {
    return res.status(401).json({ message: 'Неверный токен' });
  }
};</code></pre>
                </div>
              </div>
            </section>

            <section class="card">
              <h2>Преимущества и недостатки JWT</h2>

              <div class="pros-cons">
                <div class="pros">
                  <h3>Преимущества</h3>
                  <ul>
                    <li><strong>Статусность:</strong> Не требует хранения
                      состояния на сервере</li>
                    <li><strong>Масштабируемость:</strong> Легко масштабировать
                      без синхронизации сессий</li>
                    <li><strong>Кроссплатформенность:</strong> Работает на любых
                      платформах и языках</li>
                    <li><strong>Гибкость:</strong> Может содержать любые
                      пользовательские данные</li>
                    <li><strong>Производительность:</strong> Быстрая проверка
                      без обращения к базе данных</li>
                  </ul>
                </div>

                <div class="cons">
                  <h3>Недостатки</h3>
                  <ul>
                    <li><strong>Размер:</strong> Токены больше, чем
                      идентификаторы сессий</li>
                    <li><strong>Невозможность отзыва:</strong> Токен
                      действителен до истечения срока</li>
                    <li><strong>Безопасность данных:</strong> Полезная нагрузка
                      видна всем (используйте шифрование)</li>
                    <li><strong>Сложность управления:</strong> Требуется
                      стратегия для refresh токенов</li>
                  </ul>
                </div>
              </div>
            </section>

            <section class="card">
              <h2>Refresh Tokens</h2>
              <p>Для решения проблемы невозможности отзыва JWT используются
                refresh tokens:</p>

              <div class="refresh-tokens">
                <div class="refresh-concept">
                  <h3>Access Token</h3>
                  <ul>
                    <li>Короткоживущий (15-60 минут)</li>
                    <li>Используется для доступа к защищенным ресурсам</li>
                    <li>Передается с каждым запросом</li>
                  </ul>
                </div>

                <div class="refresh-concept">
                  <h3>Refresh Token</h3>
                  <ul>
                    <li>Долгоживущий (дни, недели, месяцы)</li>
                    <li>Хранится безопасно на клиенте</li>
                    <li>Используется для получения нового access token</li>
                    <li>Может быть отозван сервером</li>
                  </ul>
                </div>
              </div>

              <div class="refresh-flow">
                <h3>Поток обновления токенов:</h3>
                <ol>
                  <li>Пользователь аутентифицируется и получает access и refresh
                    токены</li>
                  <li>Access token истекает</li>
                  <li>Клиент отправляет refresh token для получения нового
                    access token</li>
                  <li>Сервер проверяет refresh token и выдает новый access
                    token</li>
                  <li>При необходимости сервер может отозвать refresh token</li>
                </ol>
              </div>
            </section>

            <section class="card">
              <h2>Библиотеки для работы с JWT</h2>

              <div class="libraries">
                <div class="library">
                  <h3>Node.js</h3>
                  <ul>
                    <li><strong>jsonwebtoken</strong> — самая популярная
                      библиотека</li>
                    <li><strong>jose</strong> — современная, соответствует
                      последним стандартам</li>
                  </ul>
                </div>

                <div class="library">
                  <h3>Python</h3>
                  <ul>
                    <li><strong>PyJWT</strong> — основная библиотека для
                      Python</li>
                    <li><strong>python-jose</strong> — поддерживает больше
                      алгоритмов</li>
                  </ul>
                </div>

                <div class="library">
                  <h3>Java</h3>
                  <ul>
                    <li><strong>java-jwt</strong> — библиотека от Auth0</li>
                    <li><strong>jjwt</strong> — Java JWT: JSON Web Token for
                      Java and Android</li>
                  </ul>
                </div>

                <div class="library">
                  <h3>.NET</h3>
                  <ul>
                    <li><strong>System.IdentityModel.Tokens.Jwt</strong> —
                      официальная библиотека Microsoft</li>
                  </ul>
                </div>
              </div>
            </section>
          </div>

          <aside class="sidebar" role="complementary">
            <div class="card">
              <h3>Быстрая навигация</h3>
              <nav aria-label="Боковая навигация">
                <ul class="sidebar-nav">
                  <li><a href="#video">Видеообзор</a></li>
                  <li><a href="#structure">Структура JWT</a></li>
                  <li><a href="#claims">Типы утверждений</a></li>
                  <li><a href="#algorithms">Алгоритмы подписи</a></li>
                  <li><a href="#implementation">Реализация</a></li>
                  <li><a href="security.html#jwt-security">Безопасность
                      JWT</a></li>
                  <li><a href="comparison.html">Сравнение с OAuth</a></li>
                </ul>
              </nav>
            </div>

            <div class="card">
              <h3>Полезные ресурсы</h3>
              <ul class="resources">
                <li><a href="https://jwt.io" target="_blank">JWT.io — Декодер и
                    отладчик</a></li>
                <li><a href="https://tools.ietf.org/html/rfc7519"
                    target="_blank">RFC 7519 — Спецификация JWT</a></li>
                <li><a href="https://auth0.com/docs/jwt"
                    target="_blank">Документация Auth0 по JWT</a></li>
              </ul>
            </div>

            <div class="card">
              <h3>Практические примеры</h3>
              <p>Изучите готовые примеры реализации JWT в разделе <a
                  href="install.html">Установка</a>.</p>
              <a href="install.html" class="button">Перейти к примерам</a>
            </div>
          </aside>
        </main>
        <footer class="footer" role="contentinfo">
          <div>© 2025 AuthMaster — Учебный проект. Все права защищены.</div>
        </footer>
      </div>
      <script src="js/main.js" defer></script>
    </body>
  </html>